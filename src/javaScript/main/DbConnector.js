connect to the JS

fix some bug

better connection routine

more efficient db routine
